
{% extends "sellor/sellor_base.html" %}
{% load static %}
{% block title %}Page Title{% endblock title %}

{% block link %}
<link href= 'https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css'> 
  
    <script src= 'https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js'> 
    </script> 
  
    <script src= 'https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'> 
    </script> 
    
  
    <link rel="stylesheet" href="styles.css"> 

{% endblock link %}

{% block style %}
* { 
	margin: 0; 
	padding: 0
} 

html { 
	height: 100%
} 

h2{ 
	color: #2F8D46; 
} 
#form { 
	text-align: center; 
	position: relative; 
	margin-top: 20px
} 

#form fieldset { 
	background: white; 
	border: 0 none; 
	border-radius: 0.5rem; 
	box-sizing: border-box; 
	width: 100%; 
	margin: 0; 
	padding-bottom: 20px; 
	position: relative
} 

.finish { 
	text-align: center
} 

#form fieldset:not(:first-of-type) { 
	display: none
} 

#form .previous-step, .next-step { 
	width: 100px; 
	font-weight: bold; 
	color: white; 
	border: 0 none; 
	border-radius: 0px; 
	cursor: pointer; 
	padding: 10px 5px; 
	margin: 10px 5px 10px 0px; 
	float: right
} 

.form, .previous-step { 
	background: #616161; 
} 

.form, .next-step { 
	background: #2F8D46; 
} 

#form .previous-step:hover, 
#form .previous-step:focus { 
	background-color: #000000
} 

#form .next-step:hover, 
#form .next-step:focus { 
	background-color: #2F8D46
} 

.text { 
	color: #2F8D46; 
	font-weight: normal
} 

#progressbar { 
	margin-bottom: 30px; 
	overflow: hidden; 
	color: lightgrey 
} 

#progressbar .active { 
	color: #2F8D46
} 

#progressbar li { 
	list-style-type: none; 
	font-size: 15px; 
	width: 25%; 
	float: left; 
	position: relative; 
	font-weight: 400
} 

#progressbar #step1:before { 
	content: "1"
} 

#progressbar #step2:before { 
	content: "2"
} 

#progressbar #step3:before { 
	content: "3"
} 

#progressbar #step4:before { 
	content: "4"
} 

#progressbar li:before { 
	width: 50px; 
	height: 50px; 
	line-height: 45px; 
	display: block; 
	font-size: 20px; 
	color: #ffffff; 
	background: lightgray; 
	border-radius: 50%; 
	margin: 0 auto 10px auto; 
	padding: 2px
} 

#progressbar li:after { 
	content: ''; 
	width: 100%; 
	height: 2px; 
	background: lightgray; 
	position: absolute; 
	left: 0; 
	top: 25px; 
	z-index: -1
} 

#progressbar li.active:before, 
#progressbar li.active:after { 
	background: #2F8D46
} 

.progress { 
	height: 20px
} 

.progress-bar { 
	background-color: #2F8D46
}

{% endblock style %}




{% block body %}
  
<div class="container"> 
    <div class="row justify-content-center"> 
        <div class="col-11 col-sm-9 col-md-7  
            col-lg-6 col-xl-5 text-center p-0 mt-3 mb-2"> 
            <div class="px-0 pt-4 pb-0 mt-3 mb-3"> 



                {% for message in messages %}

                <div class="alert alert-{{messages.tags}}" role="alert">
                  <strong>{{message}}</strong>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="alert"
                    aria-label="Close"
                  ></button>
                </div>
      
                {% endfor %}

                <form method="post" action="{% url "add_product" %}" id="form" enctype="multipart/form-data">
                    {% csrf_token %}
                    <ul id="progressbar"> 
                        <li class="active" id="step1"> 
                            <strong>Step 1</strong> 
                        </li> 
                        <li id="step2"><strong>Step 2</strong></li> 
                         
                    </ul> 
                    <div class="progress"> 
                        <div class="progress-bar"></div> 
                    </div> <br> 
                    <fieldset> 
                        <h2>Step 1: Product Information</h2>
                            
                        <div class="form-group">
                            <label for="category">Category:</label>
                            <select class="form-control" id="category" name="category" onchange="populateSubCategories()" required>
                                <option value="" selected>Select Category</option>
                                {% for category in categories %}
                                    <option value="{{ category.id }}">{{ category.cat_name }}</option>
                              {% endfor %}
                            </select>
                            <span id="category-error" class="error-span"></span>
                        </div>
                        <div class="form-group">
                            <label for="sub_category">Sub-Category:</label>
                            <select class="form-control" id="sub_category" name="sub_category" required>
                                <option value="" selected>Select Sub-Category</option>
                                {% for subcategory in subcategories %}
                                   <option value="{{ subcategory.id }}">{{ subcategory.sub_name }}</option>
                                {% endfor %}
                            </select>
                            <span id="sub_category-error" class="error-span"></span>
                        </div>
                            <div class="form-group">
                                <label for="product_name">Product Name:</label>
                                <input type="text" class="form-control" id="product_name" name="product_name" required>
                            </div>
                            <span id="product_name-error" class="error-span"></span>

                            <div class="form-group">
                                <label for="tags">Tags:</label>
                                <input type="text" class="form-control" id="tags" name="tags" required>
                            </div>
                            <span id="tags-error" class="error-span"></span>

                            <div class="form-group">
                                <label for="about_product">About Product:</label>
                                <textarea class="form-control" id="about_product" name="about_product" required></textarea>
                            </div>
                            <span id="about_product-error" class="error-span"></span>

                            <div class="form-group">
                                <label for="auction_start_datetime">Auction Start Date and Time:</label>
                                <input type="datetime-local" class="form-control" id="auction_start_datetime" name="auction_start_datetime" required>
                                <span id="datetime-error" class="error-span"></span>
                            </div>
                            <div class="form-group">
                                <label for="auction_end_datetime">Auction End Date and Time:</label>
                                <input type="datetime-local" class="form-control" id="auction_end_datetime" name="auction_end_datetime" required>
                                <span id="datetime-error" style="color: red;"></span>
                            </div>

                            <div class="form-group">
                                <label for="current_price">Current Price:</label>
                                <input type="number" class="form-control" id="current_price" name="current_price" step="0.01" required>
                            </div>
                            <span id="current_price-error" class="error-span"></span>

                        <input type="button" name="next-step" 
                            class="next-step" value="Next Step" /> 
                    </fieldset> 
                    <fieldset> 
                        <h2>Step 2: Product Images and Certificate</h2>
                            <div class="form-group">
                                <label for="image1">Image 1:</label>
                                <input type="file" class="form-control" id="image1" name="image1" required>
                            </div>
                            <span id="image1-error" class="error-span"></span>
                            <div class="form-group">
                                <label for="image2">Image 2:</label>
                                <input type="file" class="form-control" id="image2" name="image2">
                            </div>
                            <div class="form-group">
                                <label for="image3">Image 3:</label>
                                <input type="file" class="form-control" id="image3" name="image3">
                            </div>
                            <div class="form-group">
                                <label for="image4">Image 4:</label>
                                <input type="file" class="form-control" id="image4" name="image4">
                            </div>
                            <div class="form-group">
                                <label for="authentication_certificate">Authentication Certificate:</label>
                                <input type="file" class="form-control" id="authentication_certificate" name="authentication_certificate" required>
                            </div>
                            <span id="authentication_certificate-error" class="error-span"></span>
                            
                        <input type="submit" name="next-step" 
                            class="btn btn-success  mt-2" value="submit"  /> 
                        <input type="submit" name="previous-step" 
                            class="previous-step" 
                            value="Previous Step" /> 
                    </fieldset> 
                    
                </form> 
            </div> 
        </div> 
    </div> 
</div> 



    <script>
        
        $(document).ready(function () { 
            var currentGfgStep, nextGfgStep, previousGfgStep; 
            var opacity; 
            var current = 1; 
            var steps = $("fieldset").length; 
        
            setProgressBar(current); 
        
            $(".next-step").click(function () { 
        
                currentGfgStep = $(this).parent(); 
                nextGfgStep = $(this).parent().next(); 
        
                $("#progressbar li").eq($("fieldset") 
                    .index(nextGfgStep)).addClass("active"); 
        
                nextGfgStep.show(); 
                currentGfgStep.animate({ opacity: 0 }, { 
                    step: function (now) { 
                        opacity = 1 - now; 
        
                        currentGfgStep.css({ 
                            'display': 'none', 
                            'position': 'relative'
                        }); 
                        nextGfgStep.css({ 'opacity': opacity }); 
                    }, 
                    duration: 500 
                }); 
                setProgressBar(++current); 
            }); 
        
            $(".previous-step").click(function () { 
        
                currentGfgStep = $(this).parent(); 
                previousGfgStep = $(this).parent().prev(); 
        
                $("#progressbar li").eq($("fieldset") 
                    .index(currentGfgStep)).removeClass("active"); 
        
                previousGfgStep.show(); 
        
                currentGfgStep.animate({ opacity: 0 }, { 
                    step: function (now) { 
                        opacity = 1 - now; 
        
                        currentGfgStep.css({ 
                            'display': 'none', 
                            'position': 'relative'
                        }); 
                        previousGfgStep.css({ 'opacity': opacity }); 
                    }, 
                    duration: 500 
                }); 
                setProgressBar(--current); 
            }); 
        
            function setProgressBar(currentStep) { 
                var percent = parseFloat(100 / steps) * current; 
                percent = percent.toFixed(); 
                $(".progress-bar") 
                    .css("width", percent + "%") 
            } 
        
            $(".submit").click(function () { 
                return false; 
            }) 
        }); 



// getSubCategories

    function populateSubCategories() {
        const categoryDropdown = document.getElementById("category");
        const subCategoryDropdown = document.getElementById("sub_category");

        // Clear existing sub-category options
        subCategoryDropdown.innerHTML = '<option value="" selected>Select Sub-Category</option>';

        // Get the selected category value
        const selectedCategoryId = categoryDropdown.value;

        // Loop through the subcategories and add options that match the selected category
        {% for subcategory in subcategories %}
            if ("{{ subcategory.category.id }}" === selectedCategoryId) {
                const option = document.createElement("option");
                option.value = "{{ subcategory.id }}";
                option.text = "{{ subcategory.sub_name }}";
                subCategoryDropdown.appendChild(option);
            }
        {% endfor %}
    }





   //validation
  
   
    // Function to validate if a field is not empty
    function validateNotEmpty(field, errorElement) {
        if (field.value.trim() === '') {
            errorElement.textContent = 'This field is required.';
            errorElement.style.color = 'red'; // Set error message color to red
            return false;
        } else {
            errorElement.textContent = '';
            return true;
        }
    }

  
    // Function to validate if the start date and time is at least 5 minutes from now and not greater than six months from now
function validateStartDate(startDateTime, errorElement) {
    const inputDate = new Date(startDateTime.value);
    const currentDate = new Date();
    const sixMonthsLater = new Date();
    sixMonthsLater.setMonth(currentDate.getMonth() + 6); // 6 months from now
    currentDate.setMinutes(currentDate.getMinutes() + 5); // 5 minutes from now

    if (inputDate <= currentDate) {
        errorElement.textContent = 'Start date and time must be at least 5 minutes from now.';
        errorElement.style.color = 'red'; // Set error message color to red
        return false;
    } else if (inputDate > sixMonthsLater) {
        errorElement.textContent = 'Start date must not be greater than six months from now.';
        errorElement.style.color = 'red'; // Set error message color to red
        return false;
    } else {
        errorElement.textContent = '';
        return true;
    }
}



    // Function to validate if the end date and time is greater than the start time
    function validateEndDate(startDateTime, endDateTime, errorElement) {
        const startDate = new Date(startDateTime.value);
        const endDate = new Date(endDateTime.value);
        if (startDate >= endDate) {
            errorElement.textContent = 'End date and time must be greater than the start time.';
            errorElement.style.color = 'red'; // Set error message color to red
            return false;
        } else {
            errorElement.textContent = '';
            return true;
        }
    }

    // Function to validate that current price is greater than a thousand
    function validateCurrentPrice(currentPrice, errorElement) {
        const price = parseFloat(currentPrice.value);
        if (price <= 1000) {
            errorElement.textContent = 'Current price must be greater than a thousand.';
            errorElement.style.color = 'red'; // Set error message color to red
            return false;
        } else {
            errorElement.textContent = '';
            return true;
        }
    }

    // Real-time validation for the Product Name field
    const productNameField = document.getElementById('product_name');
    const productNameError = document.getElementById('product_name-error');
    productNameField.addEventListener('input', () => {
        validateNotEmpty(productNameField, productNameError);
    });

    // Real-time validation for the Start Date and Time field
    const startDateField = document.getElementById('auction_start_datetime');
    const startDateError = document.getElementById('datetime-error');
    startDateField.addEventListener('input', () => {
        validateStartDate(startDateField, startDateError);
    });

    // Real-time validation for the End Date and Time field
    const endDateField = document.getElementById('auction_end_datetime');
    const endDateError = document.getElementById('datetime-error');
    endDateField.addEventListener('input', () => {
        validateEndDate(startDateField, endDateField, endDateError);
    });

    // Real-time validation for the Current Price field
    const currentPriceField = document.getElementById('current_price');
    const currentPriceError = document.getElementById('current_price-error');
    currentPriceField.addEventListener('input', () => {
        validateCurrentPrice(currentPriceField, currentPriceError);
    });

    // Submit form with all validations
    document.getElementById('form').addEventListener('submit', function (event) {
        event.preventDefault(); // Prevent form submission initially

        const isProductNameValid = validateNotEmpty(productNameField, productNameError);
        const isStartDateValid = validateStartDate(startDateField, startDateError);
        const isEndDateValid = validateEndDate(startDateField, endDateField, endDateError);
        const isCurrentPriceValid = validateCurrentPrice(currentPriceField, currentPriceError);

        if (isProductNameValid && isStartDateValid && isEndDateValid && isCurrentPriceValid) {
            // All validations passed, you can submit the form
            this.submit();
        }
    });

  
   


</script>

    {% endblock body %}

    <script src="script.js"></script> 

  <!-- Other content for this page -->

