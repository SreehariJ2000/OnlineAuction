{% extends "base.html" %} {% block style %}
<style>
  .form-group-inline {
    display: flex;
    justify-content: space-between;
  }
  .form-group-inline .form-control {
    width: 45%;
  }
</style>
{% endblock style %} {% block body %}

<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <h4>Sign Up</h4>
        </div>
        <div class="card-body">
          {% for message in messages %}

          <div class="alert alert-{{messages.tags}}" role="alert">
            <strong>{{message}}</strong>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
              aria-label="Close"
            ></button>
          </div>

          {% endfor %}

          <form action="http://127.0.0.1:8000/auth/signup/" method="POST" id="signup-form">
            {% csrf_token %}
            <!-- First Name and Last Name on the same row with spacing -->
            <div class="form-row">
                <div class="col">
                    <input type="text" class="form-control mb-3" placeholder="First Name" name="first_name" id="first_name" onchange="validateFirstName()" />
                    <div class="text-danger" id="first_name_error"></div>
                </div>
                <div class="col">
                    <input type="text" class="form-control mb-3" placeholder="Last Name" name="last_name" id="last_name" onchange="validateLastName()" />
                    <div class="text-danger" id="last_name_error"></div>
                </div>
            </div>
            <!-- Email with spacing -->
            <div class="form-group">
                <input type="email" class="form-control mb-3" placeholder="Email" name="email" id="email" onchange="validateEmail()" />
                <div class="text-danger" id="email_error"></div>
            </div>
            <!-- Password with spacing -->
            <div class="form-group">
                <input type="password" class="form-control mb-3" placeholder="Password" name="password" id="password" onchange="validatePassword()" />
                <div class="text-danger" id="password_error"></div>
            </div>
            <!-- Confirm Password with spacing -->
            <div class="form-group">
                <input type="password" class="form-control mb-3" placeholder="Confirm Password" name="confirm_password" id="confirm_password" onchange="validateConfirmPassword()" />
                <div class="text-danger" id="confirm_password_error"></div>
            </div>
            <!-- Sign Up Button centered -->
            <div class="text-center">
                <button type="submit" class="btn btn-primary btn-block" id="signup-button">
                    Sign Up
                </button>
            </div>
        </form>
          <div class="mt-3 text-center">
            Already a user? <a href="#">Sign In</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock body %} {% block jsfiles %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
      document
        .getElementById("signup-form")
        .addEventListener("submit", function (event) {
          var firstName = document.getElementById("first_name").value.trim();
          var lastName = document.getElementById("last_name").value.trim();
          var email = document.getElementById("email").value.trim();
          var password = document.getElementById("password").value;
          var confirmPassword = document.getElementById("confirm_password").value;
  
          // Clear previous error messages
          clearErrorMessages();
  
          // Validate empty fields
          if (firstName === "") {
            displayErrorMessage("first_name", "First name cannot be empty.");
            event.preventDefault();
            return;
          }
          if (firstName.includes(' ')) {
            displayErrorMessage('first_name', 'First name cannot contain spaces.');
            event.preventDefault();
            return;
        }

       else if (!/^[A-Za-z]+$/.test(firstName)) {
        displayErrorMessage('first_name', 'First name must contain only characters.');
        event.preventDefault();
        return;
    }
  
          
  
          if (lastName === "") {
            displayErrorMessage("last_name", "Last name cannot be empty.");
            event.preventDefault();
            return;
          }
  
          if (lastName.includes(' ')) {
              displayErrorMessage('last_name', 'Last name cannot contain spaces.');
              event.preventDefault();
              return;
          }
  
         else if (!/^[A-Za-z]+$/.test(lastName)) {
          displayErrorMessage('last_name', 'Last name must contain only characters.');
          event.preventDefault();
          return;
      }
  
  
  
          if (email === "") {
            displayErrorMessage("email", "Email cannot be empty.");
            event.preventDefault();
            return;
          } 
  
          if (password === "") {
            displayErrorMessage("password", "Password cannot be empty.");
            event.preventDefault();
            return;
          }
  
          if (confirmPassword === "") {
            displayErrorMessage(
              "confirm_password",
              "Confirm Password cannot be empty."
            );
            event.preventDefault();
            return;
          }
  
          // Validate first name (at least 2 characters)
          if (firstName.length < 2) {
            displayErrorMessage(
              "first_name",
              "First name must be at least 2 characters long."
            );
            event.preventDefault();
            return;
          }
  
          // Validate last name (at least 2 characters)
          if (lastName.length < 1) {
            displayErrorMessage(
              "last_name",
              "Last name must be at least 2 characters long."
            );
            event.preventDefault();
            return;
          }
  
          // Validate email is not empty
          if (email === "") {
            displayErrorMessage("email", "Email cannot be empty.");
            event.preventDefault();
            return;
          }
  
          // Validate password length (at least 8 characters)
          if (password.length < 8) {
            displayErrorMessage(
              "password",
              "Password must be at least 8 characters long."
            );
            event.preventDefault();
            return;
          }
  
          // Validate password contains at least one special character
          if (!/[!@#$%^&*()_+{}\[\]:;<>,.?~\\]/.test(password)) {
            displayErrorMessage(
              "password",
              "Password must contain at least one special character."
            );
            event.preventDefault();
            return;
          }
  
          // Validate password contains at least one uppercase letter
          if (!/[A-Z]/.test(password)) {
            displayErrorMessage(
              "password",
              "Password must contain at least one uppercase letter."
            );
            event.preventDefault();
            return;
          }
  
          // Validate password and confirm password match
          if (password !== confirmPassword) {
            displayErrorMessage("confirm_password", "Passwords do not match.");
            event.preventDefault();
            return;
          }
        });
  
      // Function to display error messages
      function displayErrorMessage(fieldId, message) {
        document.getElementById(fieldId + "_error").innerText = message;
      }
  
      // Function to clear error messages when user interacts with input
      var inputFields = document.querySelectorAll("input");
      inputFields.forEach(function (inputField) {
        inputField.addEventListener("input", function () {
          var fieldId = inputField.id;
          document.getElementById(fieldId + "_error").innerText = "";
        });
      });
  
      // Function to clear all error messages
      function clearErrorMessages() {
        var errorElements = document.querySelectorAll(".text-danger");
        errorElements.forEach(function (element) {
          element.innerText = "";
        });
      }
    });
  </script>
  
{% endblock jsfiles %}
