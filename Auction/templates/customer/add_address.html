{% extends "base.html" %}

{% block style %}
<style>
  /* Add your custom styles here */
  .container {
    margin-top: 50px;
  }

  .form-group {
    margin-bottom: 20px;
  }

  h1 {
    text-align: center;
  }

  .radio-group {
    display: flex;
    justify-content: space-between;
  }

  button {
    margin-right: 10px;
  }
</style>
{% endblock style %}

{% block body %}
<div class="container">
  <div class="row">
    <div class="col-md-6 mx-auto">
      <div class="card">
        <div class="card-body">
          <h1 class="card-title text-center">Add Address</h1>

          <form id="addressForm" action="{% url "add_address" %}" method="post">{% csrf_token %}

            <div class="form-group">
              <label for="name">Name:</label>
              <input type="text" class="form-control" id="name" name="name" required value="{{ address.name|default:'' }}">
              <div class="invalid-feedback"></div>
            </div>

            <div class="form-group">
              <label for="mobile">Mobile Number:</label>
              <input type="text" class="form-control" id="mobile" name="mobile" required  value="{{ address.mobile|default:'' }}">
              <div class="invalid-feedback"></div>
            </div>

            <div class="form-group">
              <label for="pincode">Pincode:</label>
              <input type="number" class="form-control" id="pincode" name="pincode" required value="{{ address.pincode|default:'' }}">
              <div class="invalid-feedback"></div>
            </div>

            <div class="form-group">
              <label for="locality">Locality:</label>
              <input type="text" class="form-control" id="locality" name="locality" required value="{{ address.locality|default:'' }}">
              <div class="invalid-feedback"></div>
            </div>

            <div class="form-group">
              <label for="address">Address (Area and Street):</label>
              <input type="text" class="form-control" id="address" name="address" required value="{{ address.address|default:'' }}">
            </div>

            <div class="form-group">
              <label for="city">City/District/Town:</label>
              <input type="text" class="form-control" id="city" name="city" required value="{{ address.city|default:'' }}">
              <div class="invalid-feedback"></div>
            </div>

            <div class="form-group">
              <label for="state">State:</label>
              <select class="form-control" id="state" name="state" required>
                  <option value="" {% if not address.state %}selected{% endif %}>-Select State-</option>
                  <option value="Andhra Pradesh" {% if address.state == 'Andhra Pradesh' %}selected{% endif %}>Andhra Pradesh</option>
                  <option value="Arunachal Pradesh" {% if address.state == 'Arunachal Pradesh' %}selected{% endif %}>Arunachal Pradesh</option>
                  <option value="Assam" {% if address.state == 'Assam' %}selected{% endif %}>Assam</option>
                  <option value="Bihar" {% if address.state == 'Bihar' %}selected{% endif %}>Bihar</option>
                  <option value="Chhattisgarh" {% if address.state == 'Chhattisgarh' %}selected{% endif %}>Chhattisgarh</option>
                  <option value="Goa" {% if address.state == 'Goa' %}selected{% endif %}>Goa</option>
                  <option value="Gujarat" {% if address.state == 'Gujarat' %}selected{% endif %}>Gujarat</option>
                  <option value="Haryana" {% if address.state == 'Haryana' %}selected{% endif %}>Haryana</option>
                  <option value="Himachal Pradesh" {% if address.state == 'Himachal Pradesh' %}selected{% endif %}>Himachal Pradesh</option>
                  <option value="Jharkhand" {% if address.state == 'Jharkhand' %}selected{% endif %}>Jharkhand</option>
                  <option value="Karnataka" {% if address.state == 'Karnataka' %}selected{% endif %}>Karnataka</option>
                  <option value="Kerala" {% if address.state == 'Kerala' %}selected{% endif %}>Kerala</option>
                  <option value="Madhya Pradesh" {% if address.state == 'Madhya Pradesh' %}selected{% endif %}>Madhya Pradesh</option>
                  <option value="Maharashtra" {% if address.state == 'Maharashtra' %}selected{% endif %}>Maharashtra</option>
                  <option value="Manipur" {% if address.state == 'Manipur' %}selected{% endif %}>Manipur</option>
                  <option value="Meghalaya" {% if address.state == 'Meghalaya' %}selected{% endif %}>Meghalaya</option>
                  <option value="Mizoram" {% if address.state == 'Mizoram' %}selected{% endif %}>Mizoram</option>
                  <option value="Nagaland" {% if address.state == 'Nagaland' %}selected{% endif %}>Nagaland</option>
                  <option value="Odisha" {% if address.state == 'Odisha' %}selected{% endif %}>Odisha</option>
                  <option value="Punjab" {% if address.state == 'Punjab' %}selected{% endif %}>Punjab</option>
                  <option value="Rajasthan" {% if address.state == 'Rajasthan' %}selected{% endif %}>Rajasthan</option>
                  <option value="Sikkim" {% if address.state == 'Sikkim' %}selected{% endif %}>Sikkim</option>
                  <option value="Tamil Nadu" {% if address.state == 'Tamil Nadu' %}selected{% endif %}>Tamil Nadu</option>
                  <option value="Telangana" {% if address.state == 'Telangana' %}selected{% endif %}>Telangana</option>
                  <option value="Tripura" {% if address.state == 'Tripura' %}selected{% endif %}>Tripura</option>
                  <option value="Uttar Pradesh" {% if address.state == 'Uttar Pradesh' %}selected{% endif %}>Uttar Pradesh</option>
                  <option value="Uttarakhand" {% if address.state == 'Uttarakhand' %}selected{% endif %}>Uttarakhand</option>
                  <option value="West Bengal" {% if address.state == 'West Bengal' %}selected{% endif %}>West Bengal</option>
              </select>
          </div>
          

            <div class="form-group">
              <label for="landmark">Landmark (Optional):</label>
              <input type="text" class="form-control" id="landmark" name="landmark" value="{{ address.landmark|default:'' }}">
            </div>

            <div class="form-group">
              <label for="alt_phone">Alternate Phone (Optional):</label>
              <input type="text" class="form-control" id="alt_phone" name="alt_phone"  value="{{ address.alt_phone|default:'' }}">
            </div>

            <div class="form-group">
              <label for="address_type">Address Type:</label>
              <div class="radio-group">
                <div class="form-check form-check-inline">
                  <input type="radio" class="form-check-input" id="home_address" name="address_type" value="home" required {% if address.address_type == 'home' %}checked{% endif %}>
                  <label class="form-check-label" for="home_address">Home</label>
                </div>

                <div class="form-check form-check-inline">
                  <input type="radio" class="form-check-input" id="work_address" name="address_type" value="work" required {% if address.address_type == 'work' %}checked{% endif %}>
                  <label class="form-check-label" for="work_address">Work</label>
                </div>
              </div>
            </div>

            <div class="form-group mt-4 ">
              <button type="submit" class="btn btn-primary">SAVE</button>
              <button type="reset" class="btn btn-secondary">CANCEL</button>
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const form = document.getElementById("addressForm");
    
    // Event listener for form submission
    form.addEventListener("submit", function(event) {
      if (!validateForm()) {
        event.preventDefault(); // Prevent form submission if validation fails
      }
    });
  
    // Event listeners for real-time validation
    form.addEventListener("input", function(event) {
      const input = event.target;
      validateField(input);
    });
  
    function validateForm() {
      let isValid = true;
  
      // Validate each field
      const fields = ["name", "mobile", "pincode", "locality", "city"];
      fields.forEach(function(field) {
        const input = form.elements[field];
        if (!validateField(input)) {
          isValid = false;
        }
      });
  
      return isValid;
    }
  
    function validateField(input) {
      const value = input.value.trim();
      const errorDiv = input.nextElementSibling;
  
      if (value === "") {
        setError(input, errorDiv, "This field is required.");
        return false;
      }

      if (input.name === "name" && !validateName(value)) {
        setError(input, errorDiv, "Invalid name. Numbers and special characters not allowed.");
        return false;
      }
  
  
      if (input.name === "mobile" && !validateMobile(value)) {
        setError(input, errorDiv, "Invalid mobile number.");
        return false;
      }
  
      if (input.name === "pincode" && !validatePincode(value)) {
        setError(input, errorDiv, "Invalid pincode.");
        return false;
      }
  
      if ((input.name === "locality" || input.name === "city") && !validateText(value)) {
        setError(input, errorDiv, "Invalid input. Numbers not allowed.");
        return false;
      }
  
      // If all validations pass, set the input as valid
      setValid(input, errorDiv);
      return true;
    }
  

    function validateName(value) {
      const nameRegex = /^[a-zA-Z ]+$/; // Only alphabets and spaces allowed
      return nameRegex.test(value);
    }
    
    function validateMobile(value) {
      const mobileRegex = /^[7890]\d{9}$/;
      return mobileRegex.test(value);
    }
  
    function validatePincode(value) {
      const pincodeRegex = /^\d{6}$/;
      return pincodeRegex.test(value);
    }
  
    function validateText(value) {
      const textRegex = /^[^\d]+$/;
      return textRegex.test(value);
    }
  
    function setError(input, errorDiv, message) {
      input.classList.add("is-invalid");
      input.classList.remove("is-valid");
      errorDiv.textContent = message;
      errorDiv.style.color = "red";
    }
  
    function setValid(input, errorDiv) {
      input.classList.remove("is-invalid");
      input.classList.add("is-valid");
      errorDiv.textContent = "";
    }
  });
  </script>
  
  
{% endblock body %}
